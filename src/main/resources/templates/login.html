<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<th:block th:replace="~{./include/userBaseLayout :: setContent( ~{:: .wrap} ) }">

    <link rel="stylesheet" th:href="@{/css/login.css}">

    <div class="logo">
        <img src="img/javabean_logo.png" alt="JavaBean Logo">
    </div>

    <form id="loginForm">
        <input type="text" id="id" placeholder="ID" required>
        <input type="password" id="password" placeholder="Password" required>

        <div class="social_login">
            <!-- ✅ 네이버 로그인 -->
            <a href="https://nid.naver.com/nidlogin.login" target="_blank">
                <img src="img/naver.png" alt="Naver Login" class="sns-icon">
            </a>

            <!-- ✅ 카카오 로그인 -->
            <a href="https://kauth.kakao.com/oauth/authorize" target="_blank">
                <img src="img/kakako.png" alt="Kakao Login" class="sns-icon">
            </a>

            <!-- ✅ 구글 로그인 -->
            <a href="https://accounts.google.com/signin" target="_blank">
                <img src="img/google.png" alt="Google Login" class="sns-icon">
            </a>
        </div>

        <div class="btn-box">
            <button type="button" class="btn" onclick="location.href='signup.html'">sign</button>
            <span>|</span>
            <button type="submit" class="btn">login</button>
            <span>|</span>
            <button type="button" class="btn" onclick="logout()">logout</button>
        </div>
    </form>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            let loginForm = document.getElementById("loginForm");

            loginForm.addEventListener("submit", (event) => {
                event.preventDefault(); // 폼 자동 제출 방지

                let idInput = loginForm.querySelector("#id").value;
                let passwordInput = loginForm.querySelector("#password").value;

                let users = JSON.parse(localStorage.getItem("users")) || [];

                let foundUser = users.find(user =>
                    user.id === idInput && user.password === passwordInput
                );

                if (foundUser) {
                    alert(`로그인 성공! ${foundUser.nickname}님 환영합니다.`);
                    let loggedInUserInfo = {
                        id: foundUser.id,
                        nickname: foundUser.nickname
                    };
                    sessionStorage.setItem('loggedInUser', JSON.stringify(loggedInUserInfo));
                    window.location.href = "index.html";
                } else {
                    alert("아이디 또는 비밀번호가 일치하지 않습니다.");
                }
            });
        });

        function logout() {
            sessionStorage.removeItem('loggedInUser');
            alert("로그아웃되었습니다.");
            window.location.href = "login.html";
        }
    </script>

</th:block>
</html>
